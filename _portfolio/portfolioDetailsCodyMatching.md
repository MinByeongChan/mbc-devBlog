# 실시간 코디매칭 서비스

2022.04 – 2023.11

## 서비스 내용

---

코디(영업사원)가 직접 방문판매를 하는것이 아닌, 매칭 서비스를 사용하여 이전보다 쉬운 영업서비스를 제공합니다.

- 서비스 지역 내에서 고객의 코디 매칭 요청이 있을 경우 코디에게 알림톡(또는 SMS 메세지)이 발송됩니다.
- 코디는 알림톡을 받고 1분 내 매칭을 승인합니다.
- 매칭이 완료된 후, 고객은 완료되었다는 메세지를 받게되며, 코디에게 제품에 대한 설명을 듣고 렌탈 및 구매하는 프로세스로 진행됩니다.

## 기술스택

---

- React, Typescript, TanStack Query, jotai, vite, AWS (S3, CloudFront)

## 개발내용

---

**Vue.js에서 React로 마이그레이션**

기존 Vue.js 로직을 React 환경으로 성공적으로 마이그레이션하였으며, 중복되는 화면 및 기능을 최소화하여 코드의 효율성을 높였습니다.

**데이터독 RUM 및 Cypress 연동**

데이터독 RUM을 연동하고 Cypress를 활용하여 E2E 테스트 코드를 작성함으로써 운영 배포 시 이슈 발생률을 최소화하여 안정적인 배포를 실현했습니다.

**GA360 활용**

GA360을 적용하여 마케팅에 유용한 정보(제품 정보, 매칭 시도 횟수, 매칭 성공 페이지 진입률 등)를 제공하여 데이터 기반 의사 결정을 지원했습니다.

**CI/CD 적용**

CI/CD를 도입하여 쉽고 안전한 배포 방식을 적용하였고, 수동 배포 스크립트를 개발하여 GitHub Publishing을 통해 배포 노트를 기록하고 버전 관리를 체계적으로 설계했습니다.

## 성장경험

1. 개발적인 측면에서 성장했습니다.
    - e2e, 테스트 코드를 본격적으로 사용했으며 운영이슈를 e2e 스크립트를 사용하여 이슈가 재발하지않도록 대응하여 마이그레이션 이후로 안정적인 서비스를 유지할 수 있도록 기여했습니다.
    - React 디자인패턴 중 아토믹 패턴 적용하여 모듈별로 세분화했습니다. 러닝커브도 깊지않고, 개발자간 사용하고자하는 컴포넌트를 손쉽게 사용할 수 있게 설계했습니다.
    - react-query를 사용하여 비동기 처리, error boundary, react-router-dom v6 loader를 사용하는 등 다양한 기술을 사용하여 사용자가 웹서비스를 이용함에 있어 UI 플리커링 현상이나, 비동기로 인한 비정상적인 동작을 최소한으로 하였습니다.
2. 커뮤니케이션 면에서 성장했습니다.
    - 기획과 백엔드의 의사소통하여 서비스의 품질을 고도화 시키려 했습니다.
    - 데이터독에서 이슈트래킹을 백엔드 개발자와 협업하여 비정상적인 API 호출에 대해 이슈 트래킹을 하여 서비스를 고도화 하였습니다.
    - 기획과 협의하에 히스토리 관리를 replace를 사용하여 기획 의도에 따라 접근 불가능한 페이지를 설정했습니다.

## 트러블 슈팅

---

**Situation**

1. 기존 레거시 버전이었던 Vue 버전을 React 버전으로 마이그레이션 하던 도중, 무분별하고 불필요하게 중복되는 컴포넌트 및 비즈니스 로직 발견
2. 코디 매칭 상태 체크를 FE에서 REST API를 사용하여 Browser에서 매 초 마다 확인하고 있었음.

**Task**

1. 무분별하게 중복되는 코드를 사용하는것은 컴포넌트 개발론과 정반대로 이어지는 개발법이라고 판단하여 중복되는 컴포넌트 공통화 및 비즈니스로직을 공통화시키는 작업이 필요하다고 판단.
2. 자바스크립트에서의 setTimeout으로 제어하기에는 부정확하다고 판단. 또한 단순 매 초 마다 단순 매칭 확인 로직을 넣어도 되는지 BE와 같이 협업 제안.

**Action**

1. 공통 컴포넌트 로직을 구성하고, 비즈니스 로직은 팀 내 공통된 처리 방안이 없었기 때문에, 훅으로 전환하여 처리. 커스텀 훅으로 전환 시, useMemo 또는 useCallback을 사용하여 시간 복잡도를 줄이려고 시도.
2. setTimeout을 매초 가 아닌, 브라우저 현재 시간을 기준으로 비교하여 현재시간을 파악하는 방식으로 변경.  또한, 매칭을 매 초 확인하는 것이 아닌, BE에서 임의의 값으로 내려주는 카운트로 수정. 매칭 확인 시간을 BE에서 제어하도록 정책 변경.

**Result**

1. 프로젝트 내 중복되는 코드양을 상당수준으로 줄일 수 있었음. 템플릿 및 레이아웃과 같은 공통된 데이터 컴포넌트를 생성함으로써 코드 재사용률이 높아졌고, React.memo, 컴포넌트 내부에서 useMemo, useCallback을 처리하여 중복되는 로직일 경우 리렌더링되는 이슈를 최소화함.
2. 브라우저 탭 전환 및 포커싱을 잃을 경우 브라우저 현재시간을 계속 불러오게 하여 이전보다 정확한 시간으로 매칭을 판단하도록 함. 매칭 시간을 BE에서 전담하는 정책으로 변경하므로 매칭 탈취율이 높아질 경우, BE에서 DB 업데이트 만으로 매칭 시간을 제어할 수 있도록 함. 비정기 배포하는 경우를 줄어들게 함.

## 이미지

---

<div style="display: flex; align-items: center; justify-content: space-around; gap: 16px; flex-wrap: wrap;">
   <img src="./assets/images/portfolio/IMG_7879.PNG" alt="마이크로사이트" width="300" />
   <img src="./assets/images/portfolio/IMG_7880.PNG" alt="마이크로사이트" width="300" />
   <img src="./assets/images/portfolio/IMG_7881.PNG" alt="마이크로사이트" width="300" />
</div>
